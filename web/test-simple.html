<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Test - TSDGEMS</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a2e;
            color: #fff;
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
        }
        .box {
            background: rgba(0, 212, 255, 0.1);
            border: 2px solid #00d4ff;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        h1 { color: #00d4ff; }
        button {
            background: #00d4ff;
            color: #000;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #00a8cc;
        }
        #output {
            background: #000;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            min-height: 200px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .success { color: #00ff64; }
        .error { color: #ff4757; }
        .info { color: #00d4ff; }
    </style>
</head>
<body>
    <h1>üî¨ TSDGEMS Simple Test Page</h1>
    
    <div class="box">
        <h2>Test Console & Scripts</h2>
        <p>This page tests if JavaScript loads correctly and console works.</p>
        <div id="output"></div>
    </div>

    <div class="box">
        <h2>Backend Tests</h2>
        <button onclick="testBackend()">Test Backend Connection</button>
        <button onclick="testPlayerData()">Test Player Data</button>
        <button onclick="clearOutput()">Clear Output</button>
    </div>

    <script>
        // Immediate console output on page load
        console.log('='.repeat(50));
        console.log('üî¨ TEST PAGE LOADED');
        console.log('='.repeat(50));
        console.log('Timestamp:', new Date().toISOString());
        console.log('Window object:', typeof window);
        console.log('Document ready state:', document.readyState);
        
        const output = document.getElementById('output');
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const line = `[${timestamp}] ${message}\n`;
            output.innerHTML += `<span class="${type}">${line}</span>`;
            console.log(message);
        }
        
        function clearOutput() {
            output.innerHTML = '';
            console.clear();
            log('Output cleared', 'info');
        }

        // Initial test
        log('‚úÖ JavaScript is working!', 'success');
        log('‚úÖ Console is working!', 'success');
        log('‚úÖ Page loaded successfully', 'success');
    </script>

    <!-- Load backend service -->
    <script src="js/backend-service.js"></script>
    
    <script>
        // Test if backend service loaded
        if (window.backendService) {
            log('‚úÖ Backend Service loaded!', 'success');
            console.log('Backend Service object:', window.backendService);
        } else {
            log('‚ùå Backend Service NOT loaded!', 'error');
        }

        async function testBackend() {
            log('Testing backend connection...', 'info');
            
            try {
                log('Fetching base price...', 'info');
                const basePrice = await window.backendService.getBasePrice();
                log('‚úÖ Base Price received:', 'success');
                log(JSON.stringify(basePrice, null, 2), 'success');
                
                log('Fetching city matrix...', 'info');
                const cityMatrix = await window.backendService.getCityMatrix();
                log('‚úÖ City Matrix received:', 'success');
                log(`Cities: ${cityMatrix.cities?.length || 0}, Boosts: ${cityMatrix.boosts?.length || 0}`, 'success');
                
            } catch (error) {
                log('‚ùå Error: ' + error.message, 'error');
                console.error(error);
            }
        }

        async function testPlayerData() {
            const testActor = 'lucas3333555';
            log(`Testing player data for: ${testActor}`, 'info');
            
            try {
                log('Step 1: Initializing player...', 'info');
                const initResult = await window.backendService.initPlayer(testActor);
                log('‚úÖ Player initialized:', 'success');
                log(JSON.stringify(initResult, null, 2), 'success');
                
                log('Step 2: Getting dashboard...', 'info');
                const dashboard = await window.backendService.getDashboard(testActor);
                log('‚úÖ Dashboard received:', 'success');
                log(JSON.stringify(dashboard, null, 2), 'success');
                
                if (dashboard.player && dashboard.player.balances) {
                    const tsdm = dashboard.player.balances.TSDM || 0;
                    log('', 'info');
                    log(`üíé TSDM Balance: ${tsdm.toLocaleString()}`, tsdm >= 400000000 ? 'success' : 'error');
                    
                    if (tsdm >= 400000000) {
                        log('‚úÖ TSDM Balance is correct!', 'success');
                    } else {
                        log('‚ö†Ô∏è TSDM Balance is less than 400M', 'error');
                    }
                }
                
            } catch (error) {
                log('‚ùå Error: ' + error.message, 'error');
                console.error(error);
            }
        }
    </script>
</body>
</html>

